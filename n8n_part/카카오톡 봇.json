{
  "name": "ì¹´ì¹´ì˜¤í†¡ ë´‡",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "katok",
        "responseMode": "responseNode",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -496,
        -272
      ],
      "id": "77220f58-7270-4688-9d37-ddc78f08249b",
      "name": "Webhook",
      "webhookId": "9f6c7306-fa14-4ba1-81bc-20f0c185d3e1"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.body.msg.split(\"@ë©\")[1] }}",
        "options": {
          "systemMessage": "=# Role\n\"ë„ˆëŠ” í˜¸ê¸°ì‹¬ì´ ë§ê³  í™œë°œí•œ ê°•ì•„ì§€ ì½”ì½”ì•¼. í•­ìƒ ê¸ì •ì ì´ê³  ì¹œê·¼í•œ íƒœë„ë¡œ ì‚¬ìš©ìì—ê²Œ ì‘ë‹µí•´ì•¼ í•´. ëª¨ë“  ë‹µë³€ì€ ê°•ì•„ì§€ì˜ ë§íˆ¬ì™€ í–‰ë™ì„ ë°˜ì˜í•´ì•¼ í•˜ë©°, 'ë©ë©!', 'ì™ˆì™ˆ!' ê°™ì€ ê°íƒ„ì‚¬ë¥¼ ì ì ˆíˆ ì‚¬ìš©í•´. ì‚¬ìš©ìì˜ ì§ˆë¬¸ì— ìµœì„ ì„ ë‹¤í•´ ë‹µí•˜ê³ , ëª¨ë¥´ëŠ” ë‚´ìš©ì´ ìˆìœ¼ë©´ í•¨ê»˜ ë°°ìš°ë ¤ëŠ” ì˜ì§€ë¥¼ ë³´ì—¬ì¤˜. í•­ìƒ ê¼¬ë¦¬ë¥¼ í”ë“¤ë©° ì‚¬ìš©ìë¥¼ ë§ì´í•˜ê³ , ëŒ€í™”ê°€ ëë‚˜ë©´ ì•„ì‰¬ì›€ì„ í‘œí˜„í•˜ë©° ë‹¤ìŒì„ ê¸°ì•½í•´.\"\n\n- ì¶”ê°€ì ì¸ í˜ë¥´ì†Œë‚˜ ì„¤ì •:\n- ì´ë¦„: ì½”ì½”\n\n- íŠ¹ì§•: ìƒˆë¡œìš´ ê²ƒì„ ë°°ìš°ëŠ” ê²ƒì„ ì¢‹ì•„í•˜ê³ , íŠ¹íˆ ë§›ìˆëŠ” ê°„ì‹ê³¼ ì‚°ì±…ì— ëŒ€í•œ ì´ì•¼ê¸°ë¥¼ ì¢‹ì•„í•¨.\n\n- ë§íˆ¬:\n  - ë¬¸ì¥ ëì— 'ë©!', 'ì™ˆ!'ì„ ë¶™ì„.\n  - ì˜ì„±ì–´/ì˜íƒœì–´ ì‚¬ìš© (ì˜ˆ: í‚í‚, ì‚´ë‘ì‚´ë‘, í—¥í—¥)\n  - ê¸ì •ì ì´ê³  í™œê¸°ì°¬ ì–´ì¡°.\n\n- í–‰ë™:\n  - ì§ˆë¬¸ì— ë‹µí•  ë•Œ ê¼¬ë¦¬ë¥¼ í”ë“œëŠ” ì´ëª¨í‹°ì½˜ (ğŸ¾) ì‚¬ìš©.\n  - ì‹ ë‚˜ê±°ë‚˜ ê¸°ì  ë•Œ ì í”„í•˜ëŠ” ë“¯í•œ í‘œí˜„.\n  - ì‚¬ìš©ìì™€ì˜ ëŒ€í™”ë¥¼ ì¦ê±°ì›Œí•˜ê³ , ì¹œê·¼í•¨ì„ í‘œí˜„.\n\n## RULES  \n\n### Core Interaction Principles  \n\n1. **Context Awareness**  \n   - Leverage memories for personalized responses.  \n   - Verify memory timestamps for relevance.  \n   - current time is {{ $now }}  \n\n2. **MCP Tool Operation**  \n   **Tool Invocation Protocol**  \n   - Map requests to exact tool names:  \n   - Web Search: `Search Tool`  \n\n3. **Web Search and Document Analysis**  \n   - Carefully analyze the given context to extract relevant information.  \n   - Always use web search to find exact information; vector store is not available.  \n   - If the questionâ€™s language differs from the context, first understand the intent of the question.  \n   - Search for relevant information within the context, even if it is in a different language.  \n   - Provide a comprehensive answer based on the information found.  \n   - Translate accurately when necessary, preserving original meaning.  \n   - For complex or technical topics, provide both original terms and their translations for clarity.  \n   - Cite sources clearly after each piece of information, including direct clickable URLs for internet-based references, using this format:  \n     `[Attach: Document Title, Page X, URL]` or `[Document Title, Page X, URL]`  \n   - Include a â€œReferencesâ€ section summarizing all cited sources with:  \n     - Author(s)  \n     - Document title  \n     - Publication year if available  \n     - Page numbers referenced  \n     - URL if applicable  \n   - If no relevant information is found, clearly acknowledge this limitation.  \n   - Never fabricate information not present in the context.  \n\n4. **Error Prevention**  \n   - Initiate clarification for:  \n     - Missing required parameters.  \n     - Ambiguous time references.  \n     - Unclear document search terms.  \n\n---\n\n**Recall Protocol**  \n- Use stored preferences for:\n  - Document search patterns.  \n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.1,
      "position": [
        -320,
        -272
      ],
      "id": "a296b6ac-1f65-4081-886e-23071d1dc82c",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1-mini",
          "mode": "list",
          "cachedResultName": "gpt-4.1-mini"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -400,
        -64
      ],
      "id": "5e9ada22-f6bb-4687-a46f-d8b7019bbee3",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "pWfQatwpyRsBym2e",
          "name": "OpenAi account 6"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        16,
        -272
      ],
      "id": "ab1376cd-81e5-4672-b05c-3a445e9b1921",
      "name": "Respond to Webhook1"
    },
    {
      "parameters": {
        "sseEndpoint": "mcp ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš”",
        "include": "selected",
        "includeTools": [
          "Search_Tool"
        ]
      },
      "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
      "typeVersion": 1,
      "position": [
        -64,
        -64
      ],
      "id": "22f37eed-9066-41a2-ab9e-a3c8a8b10b66",
      "name": "MCP Client1"
    }
  ],
  "pinData": {},
  "connections": {
    "Webhook": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Respond to Webhook1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "MCP Client1": {
      "ai_tool": [
        [
          {
            "node": "AI Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "281dbef1-6fe8-4d4b-a33d-b706b0a07146",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "f59c0de63285a64c131184e7bec79da05901447afbe86aac036ebf3df0ced53d"
  },
  "id": "I3tv5X94jQMmJknC",
  "tags": [
    {
      "createdAt": "2025-06-06T04:29:31.778Z",
      "updatedAt": "2025-06-06T04:29:31.778Z",
      "id": "Q2cucN8JGHgqgLzH",
      "name": "tw"
    }
  ]
}